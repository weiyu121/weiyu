(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c9f66cea"],{"3f9a":function(t,n,e){},"52bb":function(t,n,e){"use strict";e.d(n,"t",(function(){return u})),e.d(n,"n",(function(){return f})),e.d(n,"k",(function(){return d})),e.d(n,"d",(function(){return m})),e.d(n,"j",(function(){return p})),e.d(n,"s",(function(){return g})),e.d(n,"b",(function(){return b})),e.d(n,"f",(function(){return h})),e.d(n,"e",(function(){return v})),e.d(n,"c",(function(){return _})),e.d(n,"o",(function(){return j})),e.d(n,"p",(function(){return y})),e.d(n,"q",(function(){return k})),e.d(n,"a",(function(){return O})),e.d(n,"r",(function(){return x})),e.d(n,"g",(function(){return L})),e.d(n,"l",(function(){return I})),e.d(n,"m",(function(){return w})),e.d(n,"h",(function(){return $})),e.d(n,"i",(function(){return S}));e("d3b7");var r=e("bc3a"),o=e.n(r),i=e("4360"),a=e("56cd"),c=(e("a27e"),o.a.create({baseURL:"/model",timeout:12e4})),l="request-error";c.interceptors.request.use((function(t){return t}),(function(t){Promise.reject(t)})),c.interceptors.response.use((function(t){var n=t.data;switch(n.code){case 0:return n;case 1:i["a"].dispatch("Logout",{isReqLogOut:!1}).then((function(t){location.reload()}))}return a["a"].warning({key:l,message:n.message||"网络连接超时！",duration:2}),Promise.reject(n)}),(function(t){return a["a"].warning({key:l,message:"网络连接超时！",duration:2}),Promise.reject(t)}));var s=e("b775");function u(t){return Object(s["b"])({url:"/ai-task/"+t.id+"/alert",method:"patch",data:t})}function f(t){return Object(s["b"])({url:"/ai-task/"+t.id+"/alert",method:"get"})}function d(t){return Object(s["b"])({url:"/ai-project",method:"get",params:t})}function m(t){return Object(s["b"])({url:"/ai-project/"+t.id,method:"delete"})}function p(t){return Object(s["b"])({url:"/ai-project/"+t.id,method:"get",params:t})}function g(t,n){return Object(s["b"])({url:"/ai-project/"+t.id,method:"patch",data:n})}function b(t){return Object(s["b"])({url:"/ai-project",method:"post",data:t})}function h(t){return Object(s["b"])({url:"/ai-task",method:"get",params:t})}function v(t){return Object(s["b"])({url:"/ai-task/"+t.id,method:"get"})}function _(t){return Object(s["b"])({url:"/ai-task/"+t.id,method:"delete"})}function j(t){return Object(s["b"])({url:"/ai-project/default",method:"patch",data:t})}function y(t){return Object(s["b"])({url:"/ai-task/"+t.id+"/start",method:"post"})}function k(t){return Object(s["b"])({url:"/ai-task/"+t.id+"/stop",method:"post"})}function O(t){return Object(s["b"])({url:"/ai-task",method:"post",data:t})}function x(t){return Object(s["b"])({url:"/ai-task/"+t.id,method:"patch",data:t})}function L(t){return Object(s["b"])({url:"/ai-task/"+t.id+"/status",method:"get",params:t})}function I(t,n){return Object(s["b"])({url:"/ai-project/"+t.id+"/model",method:"patch",data:n})}function w(t,n){return Object(s["b"])({url:"/ai-project/"+t.id,method:"patch",data:n})}function $(t){return Object(s["b"])({url:"system/modelhub/list",method:"get",params:t})}function S(t){return c({url:"/openapi/selectVersionByModelId",method:"get",params:t})}},8073:function(t,n,e){"use strict";e.r(n);var r=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("a-spin",{attrs:{spinning:t.spinning,tip:"Loading..."}},[e("a",{staticStyle:{position:"absolute",top:"-64px",right:"0px","font-weight":"500","font-size":"16px"},on:{click:t.addComInteraction}},[t._v("新增事件")]),e("a-form-model",t._b({ref:"form",attrs:{layout:"horizontal",model:t.form,rules:t.form.rules}},"a-form-model",t.form.layout,!1),t._l(t.form.val.alert_config,(function(n,r){return e("div",{key:r},[e("a-card",{attrs:{title:"事件"+(r+1)}},[e("a-button",{attrs:{slot:"extra",type:"link",icon:"delete"},on:{click:function(n){return t.deleteInteraction(r)}},slot:"extra"}),e("a-form-model-item",{attrs:{label:"事件名称",prop:"event"}},[e("a-input",{model:{value:t.form.val.alert_config[r].event,callback:function(n){t.$set(t.form.val.alert_config[r],"event",n)},expression:"form.val.alert_config[index].event"}})],1),e("a-form-model-item",{attrs:{label:"选择区域",prop:"region"}},[e("a-select",{attrs:{placeholder:"请选择"},model:{value:t.form.val.alert_config[r].region,callback:function(n){t.$set(t.form.val.alert_config[r],"region",n)},expression:"form.val.alert_config[index].region"}},t._l(t.regionList,(function(n,r){return e("a-select-option",{key:r,attrs:{value:n}},[t._v(t._s(n))])})),1)],1),e("a-form-model-item",{attrs:{label:"事件对象",prop:"coditions"}},[e("a-select",{attrs:{placeholder:"请选择事件对象"},model:{value:t.form.val.alert_config[r].object,callback:function(n){t.$set(t.form.val.alert_config[r],"object",n)},expression:"form.val.alert_config[index].object"}},t._l(t.propertys.objects,(function(n,r){return e("a-select-option",{key:r,attrs:{value:n}},[t._v(" "+t._s(n)+" ")])})),1)],1),e("a-form-model-item",{attrs:{label:"触发方式",prop:"coditions"}},[e("a-select",{attrs:{placeholder:"请选择事件触发方式"},model:{value:t.form.val.alert_config[r].condition,callback:function(n){t.$set(t.form.val.alert_config[r],"condition",n)},expression:"form.val.alert_config[index].condition"}},t._l(t.propertys.conditions,(function(n,r){return e("a-select-option",{key:r,attrs:{value:n.name}},[t._v(" "+t._s(n.name)+" ")])})),1)],1),t._l(t.conditionMap[t.form.val.alert_config[r].condition],(function(n,o){return e("a-form-model-item",t._b({key:o},"a-form-model-item",t.form.col,!1),[e("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(n.name)+" "),e("a-tooltip",{attrs:{title:n.description}},[e("a-icon",{attrs:{type:"question-circle-o"}})],1)],1),"number"===n.type||"integer"===n.type?e("a-input-number",{staticStyle:{width:"100%"},attrs:{precision:0},model:{value:t.form.val.alert_config[r].args[o],callback:function(n){t.$set(t.form.val.alert_config[r].args,o,n)},expression:"form.val.alert_config[index].args[proIdx]"}}):e("a-input",{attrs:{placeholder:"请输入"},model:{value:t.form.val.alert_config[r].args[o],callback:function(n){t.$set(t.form.val.alert_config[r].args,o,n)},expression:"form.val.alert_config[index].args[proIdx]"}})],1)}))],2)],1)})),0)],1),this.form.val.alert_config.length>0?[e("a-form-item",{staticClass:"form-btn",staticStyle:{position:"relative"}},[e("a-button",{on:{click:function(n){return t.closeDetail(!1)}}},[t._v("取消")]),e("a-button",{attrs:{type:"primary",loading:t.form.confirmLoading},on:{click:function(n){return t.onSubmit("form")}}},[t._v("确定")])],1)]:t._e()],2)},o=[],i=e("f3f3"),a=e("54f8"),c=(e("d3b7"),e("4160"),e("159b"),e("b0c0"),e("a434"),e("52bb")),l={props:{currentInfo:{type:Object,required:!0},regionInfo:{type:Array,default:function(){return[]}}},data:function(){return{spinning:!1,form:{layout:{labelCol:{span:4},wrapperCol:{span:18}},confirmLoading:!1,visible:!1,val:{alert_config:[]},rules:{}},regionList:["整个画面"],orgin_ai_task_id:0,orgin_alert_config:[],serverList:[],propertys:{},conditionMap:{}}},watch:{"currentInfo.id":{handler:"resetForm",immediate:!0},regionInfo:{handler:"initRegionList"}},created:function(){},methods:{getServes:function(){var t=this;Object(c["k"])().then((function(n){t.serverList=n.ai_project_list||[]}))},changeServer:function(t){var n=this;this.spinning=!0,t!==this.orgin_ai_task_id?this.form.val.alert_config=[]:this.form.val.alert_config=this.orgin_alert_config,Object(c["j"])({id:t}).then((function(t){n.propertys=t.alert_config||{},n.propertys.conditions.forEach((function(t){n.conditionMap[t.name]=t.args}))}))["finally"]((function(){n.spinning=!1}))},initRegionList:function(t){if(this.regionList=["整个画面"],t){var n,e=Object(a["a"])(t);try{for(e.s();!(n=e.n()).done;){var r=n.value;this.regionList.push(r.name)}}catch(o){e.e(o)}finally{e.f()}}},resetForm:function(t){var n=this;t&&(this.form.confirmLoading=!1,this.$nextTick((function(){n.$refs.form.clearValidate()})),this.form.val={alert_config:[]},this.propertys={},this.conditionMap={},this.getInfo(t))},getInfo:function(t){var n=this;this.spinning=!0,Object(c["e"])({id:t}).then((function(t){var e=t||{},r=e.ai_project_id;n.form.val.ai_project_id=r,n.orgin_ai_task_id=r,null!=r&&Object(c["j"])({id:r}).then((function(t){n.propertys=t.alert_config||{},n.propertys.conditions.forEach((function(t){n.conditionMap[t.name]=t.args}))}))}))["finally"]((function(){n.spinning=!1})),Object(c["n"])({id:t}).then((function(t){var e=t.alert||[],r=[];e.forEach((function(t){null===t.args?(null==t.region&&(t.region="整个画面"),r.push(Object(i["a"])(Object(i["a"])({},t),{},{args:[]}))):r.push(t)})),n.form.val.alert_config=r,n.orgin_alert_config=t.alert||[]}))["finally"]((function(){n.spinning=!1}))},addComInteraction:function(){this.form.val.alert_config.push({args:[]})},deleteInteraction:function(t){this.form.val.alert_config.splice(t,1),0===this.form.val.alert_config.length&&this.onSubmit("form")},onSubmit:function(t){var n=this;this.$refs[t].validate((function(t){if(t){n.form.confirmLoading=!0;var e,r=n.currentInfo.id,o=[],i=Object(a["a"])(n.form.val.alert_config);try{for(i.s();!(e=i.n()).done;){var l=e.value,s=Object.assign({},l);null==n.conditionMap[s.condition]&&(s.args=null),"整个画面"===s.region&&(s.region=null),o.push(s)}}catch(f){i.e(f)}finally{i.f()}var u={alert:o};u.id=r,n.updateInfo(c["t"],u)}}))},updateInfo:function(t,n){var e=this;t(n).then((function(){e.$message.success("数据提交成功！"),e.closeDetail(!0)}))["finally"]((function(){e.form.confirmLoading=!1}))},closeDetail:function(t){this.form.confirmLoading=!1,this.$emit("emitToParent",t)}}},s=l,u=(e("8f7f"),e("2877")),f=Object(u["a"])(s,r,o,!1,null,"d22889ae",null);n["default"]=f.exports},"8f7f":function(t,n,e){"use strict";e("3f9a")}}]);