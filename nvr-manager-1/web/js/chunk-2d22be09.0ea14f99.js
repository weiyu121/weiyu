(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22be09"],{f19a:function(e,t,o){"use strict";o.r(t);var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("a-spin",{attrs:{spinning:e.spinning,tip:"Loading..."}},[o("a-form-model",{ref:"form",attrs:{model:e.form.val,rules:e.form.rules,"label-col":e.form.labelCol,"wrapper-col":e.form.wrapperCol}},[o("a-form-model-item",{attrs:{label:"创建方式",prop:"mode"}},[o("a-radio-group",{attrs:{disabled:!e.currentInfo.isAdd},model:{value:e.form.val.mode,callback:function(t){e.$set(e.form.val,"mode",t)},expression:"form.val.mode"}},[o("a-radio",{attrs:{value:0}},[e._v("本地创建")]),o("a-radio",{attrs:{value:1}},[e._v("云端创建")])],1)],1),o("a-form-model-item",{attrs:{label:"默认AI服务",prop:"default"}},[o("a-radio-group",{model:{value:e.form.val.default,callback:function(t){e.$set(e.form.val,"default",t)},expression:"form.val.default"}},[o("a-radio",{attrs:{value:!1}},[e._v("否")]),o("a-radio",{attrs:{value:!0}},[e._v("是")])],1)],1),e.form.val.mode?[o("a-form-model-item",{attrs:{label:"选择模型",prop:"model_hub_id"}},[o("a-select",{attrs:{"show-search":"",placeholder:"请选择"},model:{value:e.form.val.model_hub_id,callback:function(t){e.$set(e.form.val,"model_hub_id",t)},expression:"form.val.model_hub_id"}},[e.fetching?o("a-spin",{attrs:{slot:"notFoundContent",size:"small"},slot:"notFoundContent"}):e._e(),e._l(e.modelList,(function(t,i){return o("a-select-option",{key:i,attrs:{value:i}},[e._v(e._s(t.name)+" : "+e._s(t.version))])}))],2)],1)]:[o("a-form-model-item",{attrs:{label:"项目文件",prop:"project_zip"}},[o("a-upload",{attrs:{accept:"application/zip","file-list":e.fileList,"before-upload":e.beforeUpload,remove:e.handleRemove}},[o("a-button",[o("a-icon",{attrs:{type:"upload"}}),e._v("选择文件 ")],1)],1)],1)]],2)],1),o("a-form-item",{staticClass:"form-btn"},[o("a-button",{on:{click:function(t){return e.closeDetail(!1)}}},[e._v("取消")]),o("a-button",{attrs:{type:"primary",loading:e.form.confirmLoading},on:{click:function(t){return e.onSubmit("form")}}},[e._v("确定")])],1)],1)},a=[],r=(o("d3b7"),o("4160"),o("159b"),o("c975"),o("b0c0"),o("52bb")),n={props:{currentInfo:{type:Object,required:!0}},data:function(){return{fetching:!0,fileList:[],spinning:!1,form:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}},confirmLoading:!1,val:{default:!1},rules:{project_zip:[{required:!0,message:"不可为空",trigger:"change"}],mode:[{required:!0,message:"不可为空",trigger:"change"}],model_hub_id:[{required:!0,message:"不可为空",trigger:"change"}]}},modelList:{}}},watch:{"currentInfo.id":{handler:"resetForm",immediate:!0}},created:function(){this.getModelData()},methods:{getModelData:function(){var e=this;this.fetching=!0,Object(r["h"])().then((function(t){var o={};(t.model_list||[]).forEach((function(e){o[e.serveId]=e})),e.modelList=o}))["finally"]((function(t){e.fetching=!1}))},beforeUpload:function(e){var t=-1!==e.name.indexOf("zip");t||this.$message.error("当前仅支持.zip文件");var o=e.size/1024/1024<100;return o||this.$message.error("文件大小不可超过 100MB!"),t&&o&&(this.fileList=[e],this.$set(this.form.val,"project_zip",e)),!1},handleRemove:function(e){return this.fileList=[],this.$set(this.form.val,"file",void 0),!0},resetForm:function(e){var t=this;this.form.confirmLoading=!1,this.$nextTick((function(){t.$refs.form.clearValidate()})),this.fileList=[],this.currentInfo.isAdd?this.form.val={mode:0,default:!1}:this.getInfo()},getInfo:function(){var e=this;this.spinning=!0;var t=this.currentInfo.id;Object(r["j"])({id:t}).then((function(t){var o=t.content||{},i=o.id,a=o.files,r=o.project_zip;e.form.val={id:i,files:a,project_zip:r,default:t.content["default"]}}))["finally"]((function(t){e.spinning=!1}))},closeDetail:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.form.confirmLoading=!1,this.$emit("emitToParent",e,t)},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){if(e){t.form.confirmLoading=!0;var o=t.currentInfo.isAdd,i=t.form.val,a=i.mode,n=i.model_hub_id,l=new FormData;if(0===a)t.fileList.forEach((function(e){l.append("project_zip",e)}));else{var s=t.modelList[n].giteeAddress;l.append("git_url",s)}var f=o?r["b"]:r["s"];t.updateInfo(f,l)}}))},updateInfo:function(e,t){var o=this;e(t).then((function(e){o.$message.success("数据提交成功！")}))["finally"]((function(){o.form.confirmLoading=!1,o.closeDetail(!0,1)}))}}},l=n,s=o("2877"),f=Object(s["a"])(l,i,a,!1,null,null,null);t["default"]=f.exports}}]);