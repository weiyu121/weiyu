(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2253cb"],{e417:function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("a-spin",{attrs:{spinning:e.spinning,tip:"Loading..."}},[t("a-form-model",{ref:"form",attrs:{model:e.form.val,rules:e.form.rules,"label-col":e.form.labelCol,"wrapper-col":e.form.wrapperCol}},[t("a-form-model-item",{attrs:{label:"选择监控",prop:"device_id"}},[t("a-select",{attrs:{"show-search":"",placeholder:"请选择",disabled:!e.currentInfo.isAdd},model:{value:e.form.val.device_id,callback:function(a){e.$set(e.form.val,"device_id",a)},expression:"form.val.device_id"}},e._l(e.cameraMap,(function(a,r){return t("a-select-option",{key:r,attrs:{value:r}},[e._v(e._s(a))])})),1)],1),e._l(e.propertys,(function(a,r){return t("a-form-model-item",{key:r,attrs:{prop:r}},[t("span",{attrs:{slot:"label"},slot:"label"},[e._v(" "+e._s(a.name)+" "),t("a-tooltip",{attrs:{title:a.help}},[t("a-icon",{attrs:{type:"question-circle-o"}})],1)],1),a.switch?t("a-switch",{model:{value:e.form.val.args[r],callback:function(a){e.$set(e.form.val.args,r,a)},expression:"form.val.args[proKey]"}}):a.int_range?t("a-input-number",{staticStyle:{width:"120px"},attrs:{min:a.int_range.min,max:a.int_range.max,precision:0,placeholder:a.int_range.min+"~"+a.int_range.max+"的整数"},model:{value:e.form.val.args[r],callback:function(a){e.$set(e.form.val.args,r,a)},expression:"form.val.args[proKey]"}}):a.float_range?t("a-input-number",{staticStyle:{width:"120px"},attrs:{min:a.float_range.min,max:a.float_range.max,placeholder:a.float_range.min+"~"+a.float_range.max+"的数字"},model:{value:e.form.val.args[r],callback:function(a){e.$set(e.form.val.args,r,a)},expression:"form.val.args[proKey]"}}):a.choices&&a.choices.length?t("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",allowClear:""},model:{value:e.form.val.args[r],callback:function(a){e.$set(e.form.val.args,r,a)},expression:"form.val.args[proKey]"}},e._l(a.choices,(function(a){return t("a-select-option",{key:a,attrs:{value:a}},[e._v(" "+e._s(a)+" ")])})),1):a.muti_choices&&a.muti_choices.length?t("a-select",{staticStyle:{width:"100%"},attrs:{mode:"multiple",placeholder:"请选择",allowClear:""},model:{value:e.form.val.args[r],callback:function(a){e.$set(e.form.val.args,r,a)},expression:"form.val.args[proKey]"}},e._l(a.choices,(function(a){return t("a-select-option",{key:a,attrs:{value:a}},[e._v(" "+e._s(a)+" ")])})),1):t("a-input",{attrs:{placeholder:"请输入"},model:{value:e.form.val.args[r],callback:function(a){e.$set(e.form.val.args,r,a)},expression:"form.val.args[proKey]"}})],1)}))],2)],1),t("a-form-item",{staticClass:"form-btn"},[t("a-button",{on:{click:function(a){return e.closeDetail(!1)}}},[e._v("取消")]),t("a-button",{attrs:{type:"primary",loading:e.form.confirmLoading},on:{click:function(a){return e.onSubmit("form")}}},[e._v("确定")])],1)],1)},n=[],o=t("f3f3"),i=(t("d3b7"),t("4160"),t("159b"),t("b0c0"),t("52bb")),s=t("abc2"),l={props:{currentInfo:{type:Object,required:!0}},data:function(){return{fileList:[],spinning:!1,form:{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:19}},confirmLoading:!1,val:{args:{}},rules:{device_id:[{required:!0,message:"不可为空",trigger:"change"}]}},cameraMap:{},propertys:{}}},watch:{"currentInfo.show":{handler:"resetForm",immediate:!0},"currentInfo.projectId":{handler:"getServeData",immediate:!0}},created:function(){this.getCameraData()},methods:{getServeData:function(e){var a=this;this.spinning=!0,Object(i["j"])({id:e}).then((function(e){a.propertys=e.optional_args||{}}))["finally"]((function(e){a.spinning=!1}))},getCameraData:function(){var e=this;Object(s["g"])({not_in_use:!0}).then((function(a){var t={},r=a.device_list||[];r.forEach((function(e){t[e.id]=e.name})),e.cameraMap=t}))},resetForm:function(e){var a=this;e&&(this.form.confirmLoading=!1,this.$nextTick((function(){a.$refs.form.clearValidate()})),this.currentInfo.isAdd?this.form.val={args:{}}:this.getInfo())},getInfo:function(){var e=this;this.spinning=!0;var a=this.currentInfo.id;Object(i["e"])({id:a}).then((function(t){var r=t||{},n=r.device_id,o=r.args;e.form.val={id:a,device_id:n,args:o}}))["finally"]((function(a){e.spinning=!1}))},closeDetail:function(e){this.form.confirmLoading=!1,this.$emit("emitToParent",e)},onSubmit:function(e){var a=this;this.$refs[e].validate((function(e){if(e){a.form.confirmLoading=!0;var t=a.currentInfo,r=t.projectId,n=t.isAdd,s=Object(o["a"])({project_id:r},a.form.val),l=n?i["a"]:i["r"];a.updateInfo(l,s)}}))},updateInfo:function(e,a){var t=this;e(a).then((function(e){t.$message.success("数据提交成功！"),t.closeDetail(!0)}))["finally"]((function(){t.form.confirmLoading=!1}))}}},c=l,f=t("2877"),m=Object(f["a"])(c,r,n,!1,null,null,null);a["default"]=m.exports}}]);