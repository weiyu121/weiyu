(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0aa275"],{1099:function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("a-spin",{attrs:{spinning:t.spinning,tip:"Loading..."}},[i("a-form-model",{ref:"form",attrs:{model:t.form.val,rules:t.form.rules,"label-col":t.form.labelCol,"wrapper-col":t.form.wrapperCol}},[i("a-form-model-item",{attrs:{label:"新文件",prop:"project_zip"}},[i("a-upload",{attrs:{accept:"application/zip","file-list":t.fileList,"before-upload":t.beforeUpload,remove:t.handleRemove}},[i("a-button",[i("a-icon",{attrs:{type:"upload"}}),t._v("上传文件 ")],1)],1)],1),i("a-alert",{attrs:{type:"warning","show-icon":"",message:"注：不上传文件将自动从云端更新"}})],1)],1),i("a-form-item",{staticClass:"form-btn"},[i("a-button",{on:{click:function(e){return t.closeDetail(!1)}}},[t._v("取消")]),i("a-button",{attrs:{type:"primary",loading:t.form.confirmLoading},on:{click:function(e){return t.onSubmit("form")}}},[t._v("确定")])],1)],1)},n=[],r=(i("c975"),i("b0c0"),i("4160"),i("159b"),i("d3b7"),i("52bb")),a={props:{currentInfo:{type:Object,required:!0}},data:function(){return{versionList:{},fileData:[],fileList:[],fileKey:0,spinning:!1,form:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}},confirmLoading:!1,val:{},rules:{}}}},watch:{"currentInfo.show":{handler:"resetForm",immediate:!0}},methods:{beforeUpload:function(t){var e=-1!==t.name.indexOf("zip");e||this.$message.error("当前仅支持.zip文件");var i=t.size/1024/1024<100;return i||this.$message.error("文件大小不可超过 100MB!"),e&&i&&(this.fileList=[t],this.$set(this.form.val,"project_zip",t)),!1},handleRemove:function(t){return this.fileList=[],this.$set(this.form.val,"file",void 0),!0},resetForm:function(t){var e=this;t&&(this.form.confirmLoading=!1,this.$nextTick((function(){e.$refs.form.clearValidate()})),this.form.val={},this.fileList=[])},closeDetail:function(t){this.form.confirmLoading=!1,this.$emit("emitToParent",t)},onSubmit:function(t){var e=this;this.$refs[t].validate((function(t){if(t){e.form.confirmLoading=!0;var i=new FormData,o=e.currentInfo.id;e.fileList.forEach((function(t){i.append("project_zip",t)})),e.updateInfo({id:o},i)}}))},updateInfo:function(t,e){var i=this;Object(r["m"])(t,e).then((function(t){i.$message.success("数据提交成功！"),i.closeDetail(!0)}))["finally"]((function(){i.form.confirmLoading=!1}))}}},s=a,l=i("2877"),f=Object(l["a"])(s,o,n,!1,null,null,null);e["default"]=f.exports}}]);