(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77a90af1"],{"093a":function(t,e,a){"use strict";a.d(e,"g",(function(){return r})),a.d(e,"c",(function(){return i})),a.d(e,"h",(function(){return o})),a.d(e,"b",(function(){return c})),a.d(e,"a",(function(){return u})),a.d(e,"f",(function(){return d})),a.d(e,"e",(function(){return s})),a.d(e,"d",(function(){return l}));var n=a("b775");function r(t){return Object(n["b"])({url:"/camera/"+t.id+"/ptz",method:"post",data:t.data})}function i(t){return Object(n["b"])({url:"/ai-task/"+t+"/region",method:"get"})}function o(t){return Object(n["b"])({url:"/ai-task/"+t.id+"/region",method:"patch",data:t.data})}function c(){return Object(n["b"])({url:"/device",method:"get"})}function u(t){return Object(n["b"])({url:"/device/"+t,method:"get"})}function d(t){return Object(n["b"])({url:"/alert",method:"get",params:t})}function s(t){return Object(n["b"])({url:"/alert/count",method:"get",params:t})}function l(){return Object(n["b"])({url:"/monitor",method:"get"})}},3069:function(t,e,a){},"3f13":function(t,e,a){"use strict";a("3069")},abc2:function(t,e,a){"use strict";a.d(e,"j",(function(){return r})),a.d(e,"o",(function(){return i})),a.d(e,"a",(function(){return o})),a.d(e,"g",(function(){return c})),a.d(e,"h",(function(){return u})),a.d(e,"d",(function(){return d})),a.d(e,"f",(function(){return s})),a.d(e,"p",(function(){return l})),a.d(e,"b",(function(){return m})),a.d(e,"n",(function(){return h})),a.d(e,"m",(function(){return f})),a.d(e,"c",(function(){return p})),a.d(e,"q",(function(){return b})),a.d(e,"e",(function(){return g})),a.d(e,"i",(function(){return y})),a.d(e,"l",(function(){return v})),a.d(e,"k",(function(){return _}));var n=a("b775");function r(){return Object(n["b"])({url:"/usbcam-search",method:"get"})}function i(t){return Object(n["b"])({url:"/cloud/forward/"+t+"/start",method:"post"})}function o(t){return Object(n["b"])({url:"/cloud/forward/"+t+"/stop",method:"post"})}function c(t){return Object(n["b"])({url:"/device",method:"get",params:t})}function u(t){return Object(n["b"])({url:"/camera",method:"get",params:t})}function d(t){return Object(n["b"])({url:"/camera/"+t.id,method:"delete"})}function s(t){return Object(n["b"])({url:"/camera/"+t.id,method:"get"})}function l(t,e){return Object(n["b"])({url:"/camera/"+t.id,method:"patch",data:e})}function m(t,e){return Object(n["b"])({url:"/camera",method:"post",data:e})}function h(t){return Object(n["b"])({url:"/source",method:"get",params:t})}function f(t){return Object(n["b"])({url:"/source/"+t.id,method:"get"})}function p(t,e){return Object(n["b"])({url:"/source",method:"post",data:e})}function b(t,e){return Object(n["b"])({url:"/source/"+t.id,method:"patch",data:e})}function g(t){return Object(n["b"])({url:"/source/"+t.id,method:"delete"})}function y(t){return Object(n["b"])({url:"/camera-search",method:"get",params:t})}function v(t){return Object(n["b"])({url:"/dvr/records",method:"get",params:t})}function _(t){return Object(n["b"])({url:"/dvr/date",method:"get",params:t})}},cc40:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-content"},[a("a-card",{staticClass:"table-search"},[a("a-form",{attrs:{layout:"inline"}},[a("a-form-item",{attrs:{label:"告警类型"}},[a("a-select",{staticStyle:{width:"200px"},attrs:{"show-search":"",placeholder:"请选择"},model:{value:t.queryParam.type,callback:function(e){t.$set(t.queryParam,"type",e)},expression:"queryParam.type"}},t._l(t.types,(function(e){return a("a-select-option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1),a("a-form-item",{attrs:{label:"筛选设备"}},[a("a-select",{staticStyle:{width:"200px"},attrs:{"show-search":"",placeholder:"请选择"},model:{value:t.queryParam.device_id,callback:function(e){t.$set(t.queryParam,"device_id",e)},expression:"queryParam.device_id"}},t._l(t.cameras,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],1),a("a-form-item",{attrs:{label:"起始时间"}},[a("a-date-picker",{attrs:{"show-time":"",placeholder:"选择时间"},on:{change:t.handleTimeChange},model:{value:t.queryParam.begin_datetime,callback:function(e){t.$set(t.queryParam,"begin_datetime",e)},expression:"queryParam.begin_datetime"}})],1),a("a-form-item",{attrs:{label:"终止时间"}},[a("a-date-picker",{attrs:{"show-time":"",placeholder:"选择时间"},on:{change:t.handleTimeChange2},model:{value:t.queryParam.end_datetime,callback:function(e){t.$set(t.queryParam,"end_datetime",e)},expression:"queryParam.end_datetime"}})],1),a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:t.searchList}},[t._v("查询")]),a("a-button",{attrs:{icon:"reload"},on:{click:t.resetForm}},[t._v("重置")])],1)],1)],1),a("a-card",[a("a-table",{attrs:{columns:t.columns,dataSource:t.pageData.records,rowKey:"id",loading:t.pageData.tableLoading,pagination:t.pagination},scopedSlots:t._u([{key:"camera",fn:function(e){return a("span",{},[t._v(" "+t._s(t.cameraMap[e])+" ")])}},{key:"action",fn:function(e,n){return a("span",{},[n.image_path?a("a",{on:{click:function(e){return t.openImgModal(n)}}},[t._v("查看图片")]):a("a",{staticStyle:{cursor:"not-allowed"}},[t._v(" 查看图片")]),a("a-divider",{attrs:{type:"vertical"}}),n.record_path?a("a",{on:{click:function(e){return t.openLiveModal(n)}}},[t._v("查看视频")]):a("a",{staticStyle:{cursor:"not-allowed"}},[t._v(" 查看视频")])],1)}}])})],1),a("a-modal",{attrs:{visible:t.modal.show,title:t.modal.title,footer:null,width:t.modal.width,"body-style":{textAlign:"center"},centered:"",destroyOnClose:""},on:{"update:visible":function(e){return t.$set(t.modal,"show",e)},cancel:function(e){t.modal.show=!1}}},["Player"===t.modal.component?a("Player",{attrs:{"current-info":t.modal}}):a("img",{staticClass:"img-box",attrs:{src:t.modal.url}})],1)],1)},r=[],i=a("f3f3"),o=(a("d3b7"),a("3ca3"),a("ddb0"),a("d81d"),a("4160"),a("159b"),a("b0c0"),a("093a")),c=a("abc2"),u=a("b775");function d(t){return Object(u["b"])({url:"/alert",method:"get",params:t})}var s="/api/alert/image",l="/api/alert/record",m=[{title:"告警来源",dataIndex:"device_name"},{title:"告警内容",dataIndex:"event"},{title:"告警时间",dataIndex:"time"},{title:"操作",dataIndex:"action",scopedSlots:{customRender:"action"},width:220}],h={components:{Player:function(){return Promise.all([a.e("flv.js"),a.e("chunk-b562abf0")]).then(a.bind(null,"ee76"))}},data:function(){var t=this;return{queryParam:{},types:[],columns:m,pagination:{total:0,pageSize:10,current:1,onShowSizeChange:function(e,a){t.pagination.current=e,t.pagination.pageSize=a,t.getList()},onChange:function(e,a){t.pagination.current=e,t.pagination.pageSize=a,t.getList()},showSizeChanger:!0,showQuickJumper:!0},pageData:{tableLoading:!1,records:[]},modal:{show:!1,type:"flv",title:"",url:""},cameraMap:{},cameras:[]}},created:function(){this.getList(),this.getType(),this.getCameraData()},methods:{handleTimeChange:function(t){t?this.queryParam.begin_datetime=t.format("YYYY-MM-DD HH:mm:ss"):delete this.queryParam.begin_datetime},handleTimeChange2:function(t){t?this.queryParam.end_datetime=t.format("YYYY-MM-DD HH:mm:ss"):delete this.queryParam.end_datetime},resetForm:function(){this.queryParam={},this.pagination.pageSize=10,this.pagination.current=1,this.getList()},searchList:function(){this.pagination.pageSize=10,this.pagination.current=1,this.getList()},getType:function(){var t=this;Object(o["e"])({group:"object"}).then((function(e){var a=e.count_list||[];t.types=[],a.map((function(e){return t.types.push(e.value)}))}))},getCameraData:function(){var t=this;Object(c["g"])().then((function(e){var a={},n=e.device_list||[];t.cameras=n,n.forEach((function(t){a[t.id]=t.name})),t.cameraMap=a}))},getList:function(){var t=this;this.pageData.tableLoading=!0;var e={type:this.queryParam.type,device_id:this.queryParam.device_id,begin_datetime:this.queryParam.begin_datetime,end_datetime:this.queryParam.end_datetime,page_size:this.pagination.pageSize,page_index:this.pagination.current};d(e).then((function(e){t.pageData.records=e.alert_list||[],t.pagination.total=e.total_count}))["finally"]((function(e){t.pageData.tableLoading=!1}))},openLiveModal:function(t){var e=t.time,a=t.record_path;this.modal=Object(i["a"])(Object(i["a"])({},this.modal),{},{component:"Player",width:"1080px",show:!0,url:l+(a?"?path="+a:""),title:e+" 告警视频"})},openImgModal:function(t){var e=t.time,a=t.image_path;this.modal=Object(i["a"])(Object(i["a"])({},this.modal),{},{component:"Img",width:"80vw",show:!0,url:s+(a?"?path="+a:""),title:e+" 告警图片"})}}},f=h,p=(a("3f13"),a("2877")),b=Object(p["a"])(f,n,r,!1,null,"4b56fbea",null);e["default"]=b.exports}}]);