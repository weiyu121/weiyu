(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ef3f28ea"],{1382:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main-content"},[n("a-card",{staticStyle:{width:"100%"},attrs:{"tab-list":t.tabList,"active-tab-key":t.key},on:{tabChange:function(e){t.key=e}}},["onvif-monitor"===t.key||"video-monitor"===t.key?["onvif-monitor"===t.key?n("div",{staticClass:"table-operator"},[n("a-button",{attrs:{slot:"extra",type:"primary"},on:{click:function(e){return t.linkTo(1,1)}},slot:"extra"},[n("a-icon",{attrs:{type:"plus"}}),t._v("新增监控 ")],1),n("a-button",{attrs:{slot:"extra",type:"primary"},on:{click:function(e){return t.linkToNearbyList(0)}},slot:"extra"},[n("a-icon",{attrs:{type:"wifi"}}),t._v("发现监控 ")],1)],1):n("div",{staticClass:"table-operator"},[n("a-button",{attrs:{slot:"extra",type:"primary"},on:{click:function(e){return t.linkTo(1,1)}},slot:"extra"},[n("a-icon",{attrs:{type:"plus"}}),t._v("新增视频源 ")],1),n("a-button",{attrs:{slot:"extra",type:"primary"},on:{click:function(e){return t.linkToNearbyList(1)}},slot:"extra"},[n("a-icon",{attrs:{type:"plus"}}),t._v("新增USB监控 ")],1)],1),n("a-table",{attrs:{rowKey:"id",columns:"onvif-monitor"===t.key?t.columns:t.columns1,dataSource:t.pageData.records,loading:t.pageData.tableLoading,pagination:!1},scopedSlots:t._u([{key:"online",fn:function(e){return"onvif-monitor"===t.key?n("span",{},[n("a-tag",{attrs:{color:e?"green":""}},[t._v(t._s(e?"在线":"离线"))])],1):t._e()}},{key:"createTime",fn:function(e){return n("span",{},[t._v(" "+t._s(t._f("moment")(e))+" ")])}},{key:"enable_forward",fn:function(e,i){return n("span",{},[n("a-switch",{attrs:{"checked-children":"开启","un-checked-children":"关闭",checked:i.enable_forward},on:{change:function(e){return t.handleEnableForwardChange(e,i)}}})],1)}},{key:"action",fn:function(e,i){return n("span",{},[i.ai_task_enable?t._e():[n("a",{on:{click:function(e){return t.openMonitor(i.id,i.ai_project_id)}}},[t._v("启用")]),n("a-divider",{attrs:{type:"vertical"}})],i.ai_task_enable?[n("a-popconfirm",{attrs:{title:"确定停止监控吗?"},on:{confirm:function(){return t.stopMonitor(i.id)}}},[n("a",{staticStyle:{color:"#ff4d4f"},attrs:{href:"javascript:;"}},[t._v("停止")])]),n("a-divider",{attrs:{type:"vertical"}}),n("a",{on:{click:function(e){return t.openVideo(i.id,i.name,i.ai_http_stream,i.support_move)}}},[t._v("播放")]),n("a-divider",{attrs:{type:"vertical"}})]:t._e(),n("a",{on:{click:function(e){return t.configAIServer(i.id,i.name)}}},[t._v("配置")]),n("a-divider",{attrs:{type:"vertical"}}),n("a",{on:{click:function(e){return t.linkToDetail(i.id,i.name)}}},[t._v("详情")]),"onvif-monitor"===t.key?[n("a-divider",{attrs:{type:"vertical"}}),n("a",{on:{click:function(e){return t.linkTo(0,i.id,i.name)}}},[t._v("修改")])]:t._e(),n("a-divider",{attrs:{type:"vertical"}}),n("a-popconfirm",{attrs:{title:"确定删除吗?"},on:{confirm:function(){return t.batchDelete(i.id)}}},[n("a",{staticStyle:{color:"#ff4d4f"},attrs:{href:"javascript:;"}},[t._v("删除")])])],2)}}],null,!0)})]:[n("VcrMonitor")]],2),n("a-drawer",{attrs:{title:t.infoDialog.title,visible:t.infoDialog.show,width:"680px",center:""},on:{"update:visible":function(e){return t.$set(t.infoDialog,"show",e)},close:function(e){t.infoDialog.show=!1}}},[n(t.infoDialog.component,{tag:"component",attrs:{"current-info":t.infoDialog},on:{emitToParent:t.getChildValue}})],1),n("a-modal",{attrs:{visible:t.modal.show,title:t.modal.title,footer:null,width:t.modal.width,"body-style":{textAlign:"center"},centered:"",destroyOnClose:""},on:{"update:visible":function(e){return t.$set(t.modal,"show",e)},cancel:function(e){t.modal.show=!1}}},[n("VideoPlayer",{attrs:{"current-info":t.modal}})],1),n("a-modal",{attrs:{title:"同步系统时间",maskClosable:!1,closable:!1},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[n("p",[t._v("检测到当前设备时间与系统时间"),n("span",{staticClass:"notice"},[t._v("严重不符")]),t._v("，请同步时间，同步时间会"),n("span",{staticClass:"notice"},[t._v("断开网络")]),t._v("需要重新连接")]),n("template",{slot:"footer"},[n("a-button",{key:"submit",attrs:{type:"primary",loading:t.updateTimeloading},on:{click:t.handlerSystemTimeSync}},[t._v(" 同步 ")])],1)],2)],1)},o=[],r=(n("d3b7"),n("3ca3"),n("ddb0"),n("0d03"),n("ac1f"),n("5319"),n("abc2")),a=n("52bb"),c=n("8593"),u=n("c1df"),s=n.n(u),d=[{title:"名称",dataIndex:"name"},{title:"编号",dataIndex:"id"},{title:"IP",dataIndex:"ip"},{title:"状态",dataIndex:"online",scopedSlots:{customRender:"online"}},{title:"品牌",dataIndex:"manufacturer"},{title:"云转发",dataIndex:"enable_forward",scopedSlots:{customRender:"enable_forward"}},{title:"操作",dataIndex:"action",scopedSlots:{customRender:"action"}}],l=[{title:"名称",dataIndex:"name"},{title:"编号",dataIndex:"id"},{title:"视频源",dataIndex:"source"},{title:"云转发",dataIndex:"enable_forward",scopedSlots:{customRender:"enable_forward"}},{title:"操作",dataIndex:"action",scopedSlots:{customRender:"action"}}],f={components:{VideoPlayer:function(){return n.e("chunk-2f72768d").then(n.bind(null,"7dc4"))},Info:function(){return n.e("chunk-3d59ffe9").then(n.bind(null,"dadc"))},Detail:function(){return n.e("chunk-bfdd6248").then(n.bind(null,"fc15"))},NearbyList:function(){return n.e("chunk-2d0a4f6d").then(n.bind(null,"094b"))},VcrMonitor:function(){return n.e("chunk-710f9129").then(n.bind(null,"3a82"))},Config:function(){return n.e("chunk-2d0bd75b").then(n.bind(null,"2ba6"))}},data:function(){var t=this;return{tabList:[{key:"onvif-monitor",tab:"局域网监控"},{key:"video-monitor",tab:"其他监控"},{key:"vcr-monitor",tab:"硬盘录像机"}],key:"onvif-monitor",columns:d,columns1:l,queryParam:{},pageData:{tableLoading:!1,records:[]},visible:!1,updateTimeloading:!1,pagination:{total:0,pageSize:10,current:1,onShowSizeChange:function(e,n){t.pagination.current=e,t.pagination.pageSize=n,t.getList()},onChange:function(e,n){t.pagination.current=e,t.pagination.pageSize=n,t.getList()},showSizeChanger:!0,showQuickJumper:!0},infoDialog:{component:"Info",show:!1,title:"新增监控",type:"add",id:""},modal:{show:!1,type:"flv",title:"",url:""}}},watch:{key:{handler:"getList"}},created:function(){this.getList()},mounted:function(){this.getSystem()},methods:{getSystem:function(){var t=this;Object(c["j"])().then((function(e){var n=e||{},i=n.time,o=s()(new Date(i)).diff(new Date,"seconds");Math.abs(o)>60&&(t.visible=!0)}))},handlerSystemTimeSync:function(){var t=this;this.updateTimeloading=!0;var e={time:s()().format("YYYY-MM-DD HH:mm:ss")};Object(c["u"])(e).then((function(e){t.$message.success("系统时间已同步！")}))["finally"]((function(){t.updateTimeloading=!1,t.visible=!1}))},openVideo:function(t,e,n,i){this.modal={id:t,show:!0,title:e,width:"1080px",live:!0,isContorl:!0,move:i,url:n.replace("localhost",location.host)}},handleEnableForwardChange:function(t,e){var n=this,i=t?r["o"]:r["a"],o=e.id;i(o).then((function(t){0===t.code&&n.getList()}))},openMonitor:function(t,e){var n=this;e?Object(a["p"])({id:t}).then((function(t){0===t.code?n.$message.success("启用成功"):n.$message.error(t.message)}))["finally"]((function(){n.getList()})):this.$message.error("请为设备关联AI项目")},stopMonitor:function(t){var e=this;Object(a["q"])({id:t}).then((function(t){0===t.code?e.$message.success("监控已停止"):e.$message.error(t.message)}))["finally"]((function(){e.getList()}))},configAIServer:function(t,e){this.infoDialog={component:"Config",show:!0,title:"配置监控："+e,id:t}},getChildValue:function(t){this.infoDialog.show=!1,t&&this.getList()},resetForm:function(){this.queryParam={},this.pagination.pageSize=10,this.pagination.current=1,this.getList()},searchList:function(){this.pagination.pageSize=10,this.pagination.current=1,this.getList()},getList:function(){var t=this;this.pageData.tableLoading=!0,"onvif-monitor"===this.key?Object(r["h"])().then((function(e){t.pageData.records=e.camera_list||[]}))["finally"]((function(e){t.pageData.tableLoading=!1})):"video-monitor"===this.key&&Object(r["n"])().then((function(e){t.pageData.records=e.source_list||[]}))["finally"]((function(e){t.pageData.tableLoading=!1}))},linkToNearbyList:function(t){this.infoDialog={component:"NearbyList",show:!0,title:"发现监控",isUSB:1===t}},linkToDetail:function(t,e){this.infoDialog={component:"Detail",show:!0,title:"监控详情："+e,id:t,key:this.key}},linkTo:function(t,e,n){this.infoDialog={component:"Info",show:!0,isAdd:t,title:t?"新增监控":"修改监控："+n,id:e,key:this.key}},batchDelete:function(t){var e=this;"video-monitor"===this.key?Object(r["e"])({id:t}).then((function(t){e.$message.success("删除成功！"),e.getList()})):Object(r["d"])({id:t}).then((function(t){e.$message.success("删除成功！"),e.getList()}))}}},m=f,b=(n("bf9f"),n("2877")),h=Object(b["a"])(m,i,o,!1,null,"4125c9b6",null);e["default"]=h.exports},3384:function(t,e,n){},"52bb":function(t,e,n){"use strict";n.d(e,"t",(function(){return d})),n.d(e,"n",(function(){return l})),n.d(e,"k",(function(){return f})),n.d(e,"d",(function(){return m})),n.d(e,"j",(function(){return b})),n.d(e,"s",(function(){return h})),n.d(e,"b",(function(){return p})),n.d(e,"f",(function(){return g})),n.d(e,"e",(function(){return v})),n.d(e,"c",(function(){return y})),n.d(e,"o",(function(){return k})),n.d(e,"p",(function(){return j})),n.d(e,"q",(function(){return w})),n.d(e,"a",(function(){return O})),n.d(e,"r",(function(){return _})),n.d(e,"g",(function(){return D})),n.d(e,"l",(function(){return L})),n.d(e,"m",(function(){return S})),n.d(e,"h",(function(){return x})),n.d(e,"i",(function(){return I}));n("d3b7");var i=n("bc3a"),o=n.n(i),r=n("4360"),a=n("56cd"),c=(n("a27e"),o.a.create({baseURL:"/model",timeout:12e4})),u="request-error";c.interceptors.request.use((function(t){return t}),(function(t){Promise.reject(t)})),c.interceptors.response.use((function(t){var e=t.data;switch(e.code){case 0:return e;case 1:r["a"].dispatch("Logout",{isReqLogOut:!1}).then((function(t){location.reload()}))}return a["a"].warning({key:u,message:e.message||"网络连接超时！",duration:2}),Promise.reject(e)}),(function(t){return a["a"].warning({key:u,message:"网络连接超时！",duration:2}),Promise.reject(t)}));var s=n("b775");function d(t){return Object(s["b"])({url:"/ai-task/"+t.id+"/alert",method:"patch",data:t})}function l(t){return Object(s["b"])({url:"/ai-task/"+t.id+"/alert",method:"get"})}function f(t){return Object(s["b"])({url:"/ai-project",method:"get",params:t})}function m(t){return Object(s["b"])({url:"/ai-project/"+t.id,method:"delete"})}function b(t){return Object(s["b"])({url:"/ai-project/"+t.id,method:"get",params:t})}function h(t,e){return Object(s["b"])({url:"/ai-project/"+t.id,method:"patch",data:e})}function p(t){return Object(s["b"])({url:"/ai-project",method:"post",data:t})}function g(t){return Object(s["b"])({url:"/ai-task",method:"get",params:t})}function v(t){return Object(s["b"])({url:"/ai-task/"+t.id,method:"get"})}function y(t){return Object(s["b"])({url:"/ai-task/"+t.id,method:"delete"})}function k(t){return Object(s["b"])({url:"/ai-project/default",method:"patch",data:t})}function j(t){return Object(s["b"])({url:"/ai-task/"+t.id+"/start",method:"post"})}function w(t){return Object(s["b"])({url:"/ai-task/"+t.id+"/stop",method:"post"})}function O(t){return Object(s["b"])({url:"/ai-task",method:"post",data:t})}function _(t){return Object(s["b"])({url:"/ai-task/"+t.id,method:"patch",data:t})}function D(t){return Object(s["b"])({url:"/ai-task/"+t.id+"/status",method:"get",params:t})}function L(t,e){return Object(s["b"])({url:"/ai-project/"+t.id+"/model",method:"patch",data:e})}function S(t,e){return Object(s["b"])({url:"/ai-project/"+t.id,method:"patch",data:e})}function x(t){return Object(s["b"])({url:"system/modelhub/list",method:"get",params:t})}function I(t){return c({url:"/openapi/selectVersionByModelId",method:"get",params:t})}},abc2:function(t,e,n){"use strict";n.d(e,"j",(function(){return o})),n.d(e,"o",(function(){return r})),n.d(e,"a",(function(){return a})),n.d(e,"g",(function(){return c})),n.d(e,"h",(function(){return u})),n.d(e,"d",(function(){return s})),n.d(e,"f",(function(){return d})),n.d(e,"p",(function(){return l})),n.d(e,"b",(function(){return f})),n.d(e,"n",(function(){return m})),n.d(e,"m",(function(){return b})),n.d(e,"c",(function(){return h})),n.d(e,"q",(function(){return p})),n.d(e,"e",(function(){return g})),n.d(e,"i",(function(){return v})),n.d(e,"l",(function(){return y})),n.d(e,"k",(function(){return k}));var i=n("b775");function o(){return Object(i["b"])({url:"/usbcam-search",method:"get"})}function r(t){return Object(i["b"])({url:"/cloud/forward/"+t+"/start",method:"post"})}function a(t){return Object(i["b"])({url:"/cloud/forward/"+t+"/stop",method:"post"})}function c(t){return Object(i["b"])({url:"/device",method:"get",params:t})}function u(t){return Object(i["b"])({url:"/camera",method:"get",params:t})}function s(t){return Object(i["b"])({url:"/camera/"+t.id,method:"delete"})}function d(t){return Object(i["b"])({url:"/camera/"+t.id,method:"get"})}function l(t,e){return Object(i["b"])({url:"/camera/"+t.id,method:"patch",data:e})}function f(t,e){return Object(i["b"])({url:"/camera",method:"post",data:e})}function m(t){return Object(i["b"])({url:"/source",method:"get",params:t})}function b(t){return Object(i["b"])({url:"/source/"+t.id,method:"get"})}function h(t,e){return Object(i["b"])({url:"/source",method:"post",data:e})}function p(t,e){return Object(i["b"])({url:"/source/"+t.id,method:"patch",data:e})}function g(t){return Object(i["b"])({url:"/source/"+t.id,method:"delete"})}function v(t){return Object(i["b"])({url:"/camera-search",method:"get",params:t})}function y(t){return Object(i["b"])({url:"/dvr/records",method:"get",params:t})}function k(t){return Object(i["b"])({url:"/dvr/date",method:"get",params:t})}},bf9f:function(t,e,n){"use strict";n("3384")}}]);