(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3d59ffe9"],{"7b0a":function(e,r,a){"use strict";function t(e){var r=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;return r.test(e)}a.d(r,"a",(function(){return t}))},dadc:function(e,r,a){"use strict";a.r(r);var t=function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("div",[a("a-spin",{attrs:{spinning:e.spinning,tip:"Loading..."}},[a("a-form-model",{ref:"form",attrs:{model:e.form.val,rules:e.form.rules,"label-col":e.form.labelCol,"wrapper-col":e.form.wrapperCol}},[a("a-form-model-item",{attrs:{label:"名称",prop:"name"}},[a("a-input",{attrs:{placeholder:"请输入"},model:{value:e.form.val.name,callback:function(r){e.$set(e.form.val,"name",r)},expression:"form.val.name"}})],1),"onvif"===e.connectType?[a("a-form-model-item",{attrs:{label:"IP",prop:"ip"}},[a("a-input",{attrs:{placeholder:"请输入"},model:{value:e.form.val.ip,callback:function(r){e.$set(e.form.val,"ip",r)},expression:"form.val.ip"}})],1),a("a-form-model-item",{attrs:{label:"码流类型"}},[a("a-select",{attrs:{"show-search":"",placeholder:"请选择"},model:{value:e.form.val.stream,callback:function(r){e.$set(e.form.val,"stream",r)},expression:"form.val.stream"}},e._l(e.streams,(function(r,t){return a("a-select-option",{key:t,attrs:{value:r.key}},[e._v(e._s(r.name))])})),1)],1),a("a-form-model-item",{attrs:{label:"端口",prop:"port"}},[a("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入"},model:{value:e.form.val.port,callback:function(r){e.$set(e.form.val,"port",r)},expression:"form.val.port"}})],1),a("a-form-model-item",{attrs:{label:"账号",prop:"username"}},[a("a-input",{attrs:{placeholder:"请输入"},model:{value:e.form.val.username,callback:function(r){e.$set(e.form.val,"username",r)},expression:"form.val.username"}})],1),a("a-form-model-item",{attrs:{label:"密码",prop:"password"}},[a("a-input",{attrs:{placeholder:"请输入"},model:{value:e.form.val.password,callback:function(r){e.$set(e.form.val,"password",r)},expression:"form.val.password"}})],1)]:[a("a-form-model-item",{attrs:{label:"地址",prop:"password"}},[a("a-input",{attrs:{placeholder:"请输入"},model:{value:e.form.val.source,callback:function(r){e.$set(e.form.val,"source",r)},expression:"form.val.source"}})],1)]],2)],1),a("a-form-item",{staticClass:"form-btn"},[a("a-button",{on:{click:function(r){return e.closeDetail(!1)}}},[e._v("取消")]),a("a-button",{attrs:{type:"primary",loading:e.form.confirmLoading},on:{click:function(r){return e.onSubmit("form")}}},[e._v("确定")])],1)],1)},o=[],n=a("f3f3"),i=(a("d3b7"),a("b0c0"),a("abc2")),l=a("7b0a"),s={props:{currentInfo:{type:Object,required:!0}},data:function(){var e=function(e,r,a){if(r&&!Object(l["a"])(r))return a(new Error("请检查 IP 格式")),!1;a()},r=function(e,r,a){if(r&&(r<0||r>65535))return a(new Error("端口必须在 0-65535 之间")),!1;a()};return{streams:[{key:0,name:"默认码流"},{key:1,name:"主码流"},{key:2,name:"子码流"},{key:3,name:"第三码流"}],spinning:!1,connectType:"onvif",form:{labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:20}},confirmLoading:!1,val:{},rules:{ip:[{validator:e,trigger:"blur"}],port:[{validator:r,trigger:"blur"}]}}}},watch:{"currentInfo.id":{handler:"resetForm",immediate:!0},"currentInfo.key":{handler:"resetForm",immediate:!0}},created:function(){},methods:{resetForm:function(e){var r=this;this.form.confirmLoading=!1,this.$nextTick((function(){r.$refs.form.clearValidate()})),this.connectType="video-monitor"===this.currentInfo.key?"other":"onvif",this.currentInfo.isAdd?this.form.val={stream:0}:this.getInfo()},getInfo:function(){var e=this;this.spinning=!0;var r=this.currentInfo.id;"onvif"===this.connectType?Object(i["f"])({id:r}).then((function(r){var a=r||{},t=a.id,o=a.name,n=a.ip,i=a.port,l=a.stream;e.form.val={id:t,name:o,ip:n,port:i,stream:l||0}}))["finally"]((function(r){e.spinning=!1})):Object(i["m"])({id:r}).then((function(r){var a=r||{},t=a.id,o=a.name,n=a.source;e.form.val={id:t,name:o,source:n}}))["finally"]((function(){e.spinning=!1}))},closeDetail:function(e){this.form.confirmLoading=!1,this.$emit("emitToParent",e)},onSubmit:function(e){var r=this;this.$refs[e].validate((function(e){if(e){r.form.confirmLoading=!0;var a=r.currentInfo,t=a.isAdd,o=a.id,l=t?{}:{id:o};if("onvif"===r.connectType){var s=r.form.val.stream,m=Object(n["a"])(Object(n["a"])({},r.form.val),{},{stream:s||void 0}),f=t?i["b"]:i["p"];r.updateInfo(f,l,m)}else{var c=Object(n["a"])({},r.form.val),u=t?i["c"]:i["q"];r.updateInfo(u,l,c)}}}))},updateInfo:function(e,r,a){var t=this;e(r,a).then((function(e){t.$message.success("数据提交成功！"),t.closeDetail(!0)}))["finally"]((function(){t.form.confirmLoading=!1}))}}},m=s,f=a("2877"),c=Object(f["a"])(m,t,o,!1,null,null,null);r["default"]=c.exports}}]);