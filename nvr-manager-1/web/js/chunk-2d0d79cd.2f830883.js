(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d79cd"],{"780f":function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("a-spin",{attrs:{spinning:e.spinning,tip:"Loading..."}},[o("a-form-model",{ref:"form",attrs:{model:e.form.val,rules:e.form.rules,"label-col":e.form.labelCol,"wrapper-col":e.form.wrapperCol}},[o("a-form-model-item",{attrs:{label:"升级方式",prop:"type"}},[o("a-radio-group",{attrs:{disabled:!e.currentInfo.modelId},model:{value:e.form.val.type,callback:function(t){e.$set(e.form.val,"type",t)},expression:"form.val.type"}},[o("a-radio",{attrs:{value:0}},[e._v("本地升级")]),o("a-radio",{attrs:{value:1}},[e._v("云端升级")])],1)],1),e.form.val.type?o("a-form-model-item",{attrs:{label:"选择版本",prop:"version"}},[o("a-select",{attrs:{"show-search":"",placeholder:"请选择"},model:{value:e.form.val.version,callback:function(t){e.$set(e.form.val,"version",t)},expression:"form.val.version"}},e._l(e.versionList,(function(t,r){return o("a-select-option",{key:r,attrs:{value:r}},[e._v(e._s(t.name))])})),1)],1):o("a-form-model-item",{attrs:{label:"新文件",prop:"model"}},[o("a-upload",{attrs:{"file-list":e.fileList,"before-upload":e.beforeUpload,remove:e.handleRemove}},[o("a-button",[o("a-icon",{attrs:{type:"upload"}}),e._v("上传文件 ")],1)],1)],1),o("a-alert",{attrs:{type:"warning","show-icon":"",message:"注：模型升级需重新启动AI服务后才可生效"}})],1)],1),o("a-form-item",{staticClass:"form-btn"},[o("a-button",{on:{click:function(t){return e.closeDetail(!1)}}},[e._v("取消")]),o("a-button",{attrs:{type:"primary",loading:e.form.confirmLoading},on:{click:function(t){return e.onSubmit("form")}}},[e._v("确定")])],1)],1)},a=[],i=(o("4160"),o("159b"),o("d3b7"),o("52bb")),n={props:{currentInfo:{type:Object,required:!0}},data:function(){return{versionList:{},fileData:[],fileList:[],fileKey:0,spinning:!1,form:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}},confirmLoading:!1,val:{},rules:{version:[{required:!0,message:"不可为空",trigger:"change"}],type:[{required:!0,message:"不可为空",trigger:"change"}],model:[{required:!0,message:"不可为空",trigger:"change"}]}}}},watch:{"currentInfo.show":{handler:"resetForm",immediate:!0},"currentInfo.modelId":{handler:"getModelData",immediate:!0}},methods:{getModelData:function(){var e=this,t=this.currentInfo.modelId;t?Object(i["i"])({modelId:t}).then((function(t){var o={};(t.content||[]).forEach((function(e){o[e.id]=e})),e.versionList=o})):this.$set(this.form.val,"type",0)},beforeUpload:function(e){var t=e.size/1024/1024<100;return t||this.$message.error("文件大小不可超过 100MB!"),t&&(this.fileList=[e],this.$set(this.form.val,"model",e)),!1},handleRemove:function(e){return this.fileList=[],this.$set(this.form.val,"model",void 0),!0},resetForm:function(e){var t=this;e&&(this.form.confirmLoading=!1,this.$nextTick((function(){t.$refs.form.clearValidate()})),this.form.val={type:0},this.fileList=[])},closeDetail:function(e){this.form.confirmLoading=!1,this.$emit("emitToParent",e)},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){if(e){t.form.confirmLoading=!0;var o=new FormData,r=t.form.val,a=r.type,i=r.version,n=t.currentInfo.id;0===a?t.fileList.forEach((function(e){o.append("model",e)})):o.append("version",i),t.updateInfo({id:n},o)}}))},updateInfo:function(e,t){var o=this;Object(i["l"])(e,t).then((function(e){o.$message.success("数据提交成功！"),o.closeDetail(!0)}))["finally"]((function(){o.form.confirmLoading=!1}))}}},s=n,l=o("2877"),f=Object(l["a"])(s,r,a,!1,null,null,null);t["default"]=f.exports}}]);