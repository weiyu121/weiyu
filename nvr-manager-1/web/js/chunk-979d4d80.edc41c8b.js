(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-979d4d80"],{"43f4":function(t,i,e){},"62f3":function(t,i,e){"use strict";e("43f4")},"68e6":function(t,i,e){"use strict";e("d79f")},"72e1":function(t,i,e){"use strict";e.r(i);var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("a-card",{attrs:{bordered:!1}},[e("a-spin",{attrs:{spinning:t.loading}},[e("Player",{staticClass:"play-back-video",attrs:{"current-info":t.modal},on:{playEnd:t.playEnd}}),e("div",{staticClass:"time-slider-box"},[e("div",{staticClass:"time-slider"},[e("div",{ref:"LiveSlider",staticClass:"live-slider-box"},[e("a-slider",{attrs:{marks:t.marks,step:6e4,max:t.max,min:t.min,"tooltip-visible":t.tipShow,"tip-formatter":t.tipFormatter,getTooltipPopupContainer:t.getPopupContainer},on:{change:t.handleDateChange},model:{value:t.currentTime,callback:function(i){t.currentTime=i},expression:"currentTime"}}),e("div",{staticClass:"video-list"},t._l(t.videoList,(function(i,a){return e("div",{key:i.id,staticClass:"video-item",style:{left:i.left+"px",width:i.width+"px"},on:{click:function(e){return t.handleVideoClick(i,a)}}})})),0)],1)])]),t.loading||t.videoList.length?t._e():e("div",{staticClass:"no-data"},[e("a-empty",{attrs:{description:"此监控暂无视频文件"}})],1)],1)],1)],1)},n=[],r=e("f3f3"),s=(e("d3b7"),e("3ca3"),e("ddb0"),e("ac1f"),e("5319"),e("d81d"),e("baa5"),e("fb6a"),e("c1df")),o=e.n(s),d=e("ca00"),l=e("abc2"),c={components:{Player:function(){return Promise.all([e.e("flv.js"),e.e("chunk-b562abf0")]).then(e.bind(null,"ee76"))}},props:{queryParam:{type:Object,required:!0}},data:function(){return{loading:!0,modal:{live:!1,url:"",bg:""},tipShow:!1,currentTime:void 0,marks:{},min:void 0,max:void 0,videoList:[]}},watch:{queryParam:{handler:"getVideoData",immediate:!0,deep:!0}},methods:{getPopupContainer:d["b"],getVideoData:function(){if(this.tipShow=!1,!this.queryParam.device_id||!this.queryParam.time)return this.videoList=[],void(this.loading=!1);this.getVideoList()},handleVideoClick:function(t,i){this.currentTime=t.startTime,this.setVideoVal(t,i)},playEnd:function(t){if(t){var i=this.videoList.length,e=this.currentIndex===i-1?0:this.currentIndex+1,a=this.videoList[e];this.currentTime=a.startTime,this.setVideoVal(a,e)}},handleDateChange:function(t){for(var i=this.videoList.length,e=0;e<i;e++){var a=this.videoList[e];if(t>a.startTime&&t<a.endTime||t===a.startTime||t===a.endTime)return void this.setVideoVal(a,e);e+1===i&&(this.currentTime=void 0)}},setVideoVal:function(t,i){var e=t.file_path,a=t.duration,n=location.origin+"/api/alert/record?path="+e.replace("localhost",location.hostname);this.modal=Object(r["a"])(Object(r["a"])({},this.modal),{},{duration:a,url:n}),this.currentIndex=i,this.tipShow=!0},formatTime:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";if(t)return o()(t).format(i)},setSliderMarker:function(t){for(var i=o()(t+"00:00","YYYY-MM-DD HH:mm").valueOf(),e=o()(t+"24:00","YYYY-MM-DD HH:mm").valueOf(),a={},n=0;n<25;n++){var r=(n>9?n:"0"+n)+":00",s=o()(t+r,"YYYY-MM-DD HH:mm").valueOf();a[s]=n%2!==0?{style:{display:"none"},label:r}:r}this.min=i,this.max=e,this.marks=a},getVideoList:function(){var t=this;this.loading=!0;var i=Object(r["a"])({deviceId:this.deviceId},this.queryParam);i.time=this.formatTime(i.time||o()()),this.setSliderMarker(i.time),Object(l["l"])(i).then((function(i){var e=i.records||[],a=e.map((function(i){var e=i.file_path.lastIndexOf("/"),a=1*i.file_path.slice(e+1,-4);i.startTime=a,i.endTime=a+1e3*i.duration;var n=t.$refs.LiveSlider.offsetWidth,r=n/86400;return i.left=(a-t.min)/1e3*r,i.width=r*i.duration,i}));if(t.videoList=a,a.length){var n=a[0];t.currentTime=n.startTime,t.setVideoVal(n,0)}}))["finally"]((function(){t.loading=!1}))},tipFormatter:function(t){return o()(t).format("HH:mm")}}},u=c,m=(e("68e6"),e("62f3"),e("2877")),f=Object(m["a"])(u,a,n,!1,null,"258829ae",null);i["default"]=f.exports},d79f:function(t,i,e){}}]);